# Parent function: tpa:teleport/next_node(teleport_state==2)
scoreboard players set #current tpa.variables 1
scoreboard players set #total tpa.variables 1
function tpa:teleport/progress_bar/main
function tpa:load_lang
title @p[tag=tpa.teleport] actionbar ["§a√§r: ", {"storage": "tpa:tpa", "nbt": "temp.progress_bar[0]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[1]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[2]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[3]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[4]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[5]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[6]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[7]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[8]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[9]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[10]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[11]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[12]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[13]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[14]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[15]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[16]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[17]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[18]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[19]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[20]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[21]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[22]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[23]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[24]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[25]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[26]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[27]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[28]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[29]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[30]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[31]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[32]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[33]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[34]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[35]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[36]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[37]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[38]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[39]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[40]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[41]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[42]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[43]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[44]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[45]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[46]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[47]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[48]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[49]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[50]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[51]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[52]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[53]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[54]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[55]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[56]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[57]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[58]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[59]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[60]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[61]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[62]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[63]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[64]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[65]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[66]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[67]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[68]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[69]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[70]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[71]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[72]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[73]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[74]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[75]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[76]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[77]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[78]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[79]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[80]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[81]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[82]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[83]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[84]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[85]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[86]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[87]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[88]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[89]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[90]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[91]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[92]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[93]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[94]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[95]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[96]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[97]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[98]"}, {"storage": "tpa:tpa", "nbt": "temp.progress_bar[99]"}, "§r  (", {"score": {"name": "#percentage", "objective": "tpa.variables"}},"%)"]

tp @p[tag=tpa.teleport] @e[sort=nearest, limit=1, tag=tpa.teleport_destin_anchor]
scoreboard players set #is_teleport_executing tpa.variables 0
execute if score #debug_mode tpa.config matches 1 run tellraw @a ["[§bTPA§r] §6 Debug: §aSuccessfully teleported §r", {"selector": "@p[tag=tpa.teleport]"}, " to ", {"entity": "@p[tag=tpa.teleport]", "nbt": "Pos"}, " in ", {"entity": "@p[tag=tpa.teleport]", "nbt": "Dimension"}, " rotated ", {"entity": "@p[tag=tpa.teleport]", "nbt": "Rotation"}]
kill @e[tag=tpa.teleport_anchor]
tag @p[tag=tpa.teleport] remove tpa.teleport